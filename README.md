# 集团分公司业务投入效能自动化分析系统

## 1. 项目概述

本项目是一个使用Python编写的自动化分析工具，旨在帮助集团公司快速、准确地评估各分公司的业务投入与产出效能。

该系统能够自动读取各分公司月度独立的财务和业务数据Excel文件，进行数据整合、核心KPI（关键绩效指标）计算、健康度评分，并最终生成一个包含可视化图表仪表盘和详细数据的综合性Excel分析报告。

为了方便初次使用和功能测试，脚本内置了模拟数据生成功能，可以一键创建符合格式要求的数据文件。

## 2.核心功能

- **自动化数据整合**：自动扫描并整合指定文件夹内所有分公司的财务与业务Excel表格。
- **关键KPI计算**：自动化计算包括但不限于：营收月度增长率、获客成本(CAC)、用户留存率、LTV（估算）、LTV/CAC比率等。
- **健康度智能评分**：根据可配置的评分规则，对各分公司的月度表现进行量化打分和评级（优秀/良好/及格/危险）。
- **可视化报告生成**：一键输出包含汇总图表仪表盘和明细数据的Excel报告，直观展示分析结果。
- **模拟数据生成**：内置测试功能，可一键生成带随机性的模拟数据，方便快速上手和功能验证。

## 3. 如何使用

### 3.1 环境准备

在运行脚本前，请确保您的电脑已经安装了Python，并安装了以下必要的库。您可以通过`pip`命令来安装它们：

```bash
pip install pandas matplotlib openpyxl
```

### 3.2 配置文件和数据

您可以通过修改`main.py`脚本底部的`main`函数中的`config`字典来进行个性化配置。

```python
def main():
    """
    主程序入口。
    """
    # ----- 脚本配置区，您可以修改以下参数 -----
    config = {
        # 数据文件夹路径（建议使用相对路径）
        'data_folder': "分公司月度数据",

        # 报告输出文件夹路径
        'report_folder': "效能分析报告",

        # 健康度评分规则
        'score_rules': {
            # 规则1: 营收月度增长率
            '营收月度增长率': {'高': 0.15, '中': 0.05}, # > 15% 得5分, > 5% 得3分
            # 规则2: LTV/CAC 比率
            'LTV/CAC 比率': {'高': 3, '中': 1},       # > 3 得5分, > 1 得3分
        }
    }
    # ...
```

- **`data_folder`**: 存放原始数据Excel文件的文件夹名称。
- **`report_folder`**: 用于保存生成的Excel报告的文件夹名称。
- **`score_rules`**: 健康度评分的阈值规则，您可以根据公司的实际考核标准进行修改。

### 3.3 运行脚本

1.  将 `main.py` 文件放置在您的项目文件夹中。
2.  打开终端（或命令行工具），进入到该项目文件夹。
3.  执行以下命令：

```bash
python main.py
```

脚本将自动执行以下步骤：
1.  （首次运行）创建`分公司月度数据`文件夹并生成模拟数据。
2.  读取数据，计算KPI和评分。
3.  创建`效能分析报告`文件夹，并存入最终的Excel报告。报告文件名将包含生成日期。

###
