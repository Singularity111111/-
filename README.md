用户手册：集团分公司业务投入效能自动化分析系统
1. 概述
本系统是一个基于Python的自动化分析脚本，旨在帮助集团总部快速评估各分公司的业务投入效能。系统自动读取月度数据，计算关键绩效指标（KPI），生成健康度评分，并最终产出一份包含图表和明细数据的Excel报告。

2. 运行环境
操作系统: Windows, macOS, Linux

Python版本: 3.7+

所需库:

pandas：用于数据处理和分析。

openpyxl：用于读写Excel文件。

matplotlib：用于生成图表。

安装方法：
打开终端或命令提示符，执行以下命令安装所需库：

pip install pandas openpyxl matplotlib

3. 使用说明
步骤 1：准备数据文件
将各分公司每月提交的标准格式的Excel文件（财务数据和业务数据）放入指定的数据文件夹。

文件命名规范：文件名前半部分为分公司名称，后半部分为日期，中间用下划线 _ 连接。

示例：公司A_财务_202310.xlsx 和 公司A_业务_202310.xlsx

财务数据文件中必须包含“营业收入”、“市场费用”等科目。

业务数据文件中必须包含“新增用户数”、“付费用户数”等指标。

请确保所有Excel文件中的工作表结构和列名（如“科目”、“指标”、“金额”）都是统一的。

步骤 2：配置脚本
打开 main.py 文件。

在 main() 函数中找到 config 字典，修改以下两个关键路径：

data_folder: 将其设置为您的数据文件夹的绝对路径（例如：D:\分公司月度数据）。

report_folder: 将其设置为您希望保存报告的文件夹的绝对路径。

步骤 3：运行程序
打开终端或命令提示符，导航到 main.py 文件所在的目录。

执行以下命令运行脚本：

python main.py

脚本运行过程中，会打印出当前执行的步骤。如果一切正常，您将在报告文件夹中找到一个以日期命名的Excel文件。

4. 交付物说明
分公司效能分析报告_YYYYMMDD.xlsx：

汇总仪表盘 Sheet：包含柱状图，直观展示各分公司的LTV/CAC比率和健康度综合得分对比。

明细数据 Sheet：存放所有原始数据以及计算出的所有KPI和评分。

5. 故障排除
文件找不到：请检查 config 中的 data_folder 路径是否正确，以及数据文件名是否符合规范。

程序崩溃：可能是Excel文件格式不正确或缺少必要的列。请检查数据文件是否为标准模板。

KPI值为NaN或Inf：通常是由于缺少上月数据（例如计算增长率和留存率）或数据中存在0值（例如新增用户数为0时计算CAC）。
