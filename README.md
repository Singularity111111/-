# 每日报表自动化生成脚本 - 使用说明 (README)

## 1. 简介 (Overview)

本脚本用于自动处理每日的原始数据，生成格式化的 **【产品日报】**。

旨在将复杂、耗时的手工数据查找、计算和整合工作完全自动化，从而极大地提高工作效率和数据的准确性。

## 2. 运行环境 (Prerequisites)

在运行此脚本前，请确保您的电脑上已安装以下软件和库：

* **Python 3**: 脚本的运行环境。
* **Pandas 库**: 用于数据处理的核心库。
* **Openpyxl 库**: 用于读取 `.xlsx` 格式的Excel文件。

您可以通过以下命令一次性安装所需的库（打开命令行工具输入并回车）：
```bash
pip install pandas openpyxl
4. 使用说明 (Usage Instructions)
您的每日工作流程非常简单，只需以下几步：

第一步：更新源文件
将您最新获取的数据源文件放入您的工作文件夹中，覆盖掉旧的文件。

第二步：配置脚本 (按需修改)
用记事本或任何文本编辑器打开 process_reports.py 文件。在文件最上方，您会看到一个清晰的【配置区域】。

指定报表日期 (可选)：

要计算特定日期：修改 target_date_str 的值，例如：target_date_str = '2025-08-25'

要自动计算最新日期：将值改为 None，即：target_date_str = None

修改数据源文件名 (仅在需要时)：

如果您的源文件名与默认名称不同，请在 FILE_CONFIG 区域进行修改。例如，如果您的产品数据源变成了 产品数据_新.xlsx，您需要将对应的行改为：
"product_data": "产品数据_新.xlsx"

第三步：运行脚本

打开您电脑的命令行工具（CMD 或 Terminal）。

使用 cd 命令进入您的工作文件夹 (例如: cd C:\Users\User\OneDrive\Desktop\2)。

输入以下命令并按回车：

Bash

python process_reports.py
第四步：查看结果
脚本运行成功后，会输出“处理完成！”的提示。届时，在同一个文件夹内，您会找到一个新生成的CSV文件，文件名会根据您计算的日期自动生成，例如：产品日报_2025-08-25.csv。

5. 注意事项 (Notes)
LTV 和历史数据: 当前脚本版本中，LTV 和 历史消耗/历史充提差 字段为占位符 (0)。

数据源准确性: 生成报表的准确性完全依赖于您提供的源文件的准确性。

Excel 显示问题: 如果生成的 .csv 文件在Excel中打开时格式错乱，请使用Excel的 【数据】->【分列】 功能或 【设置单元格格式】 功能来修正显示。
