1. 简介 (Overview)
本脚本用于自动处理每日的原始数据，生成格式化的 【产品日报】。

旨在将复杂、耗时的手工数据查找、计算和整合工作完全自动化，从而极大地提高工作效率和数据的准确性。

2. 运行环境 (Prerequisites)
在运行此脚本前，请确保您的电脑上已安装以下软件和库：

Python 3: 脚本的运行环境。

Pandas 库: 用于数据处理的核心库。

Openpyxl 库: 用于读取 .xlsx 格式的Excel文件。

您可以通过以下命令一次性安装所需的库（打开命令行工具输入并回车）：

Bash

pip install pandas openpyxl
3. 文件结构 (File Structure)
为了让脚本正常工作，您需要创建一个文件夹，并将所有必需的文件都放在里面。文件夹的结构应该如下所示：

/您的工作文件夹/
│
├── 📜 process_reports.py       (<- 这是我们的Python脚本)
│
├── 📄 Book1.xlsx               (<- 总代数据原)
├── 📄 Book2.xlsx               (<- 产品数据源)
├── 📄 Book4.xlsx               (<- 复充率表)
└── 📄 巴基斯坦消耗.xlsx        (<- 每日消耗总表)
重要提示：以上 5个文件必须 存放在同一个文件夹中。

4. 使用说明 (Usage Instructions)
您的每日工作流程非常简单，只需以下几步：

第一步：更新源文件
将您最新获取的 Book1.xlsx, Book2.xlsx, Book4.xlsx, 和 巴基斯坦消耗.xlsx 文件放入您的工作文件夹中，覆盖掉旧的文件。

第二步：指定报表日期 (可选)
用记事本或任何文本编辑器打开 process_reports.py 文件。在文件最上方，您会看到一个清晰的【日期设置区域】。

要计算特定日期：
请修改这一行，例如计算8月25日：
target_date_str = '2025-08-25'

要自动计算最新日期：
请将这一行的值改为 None：
target_date_str = None

第三步：运行脚本

打开您电脑的命令行工具（CMD 或 Terminal）。

使用 cd 命令进入您的工作文件夹。例如： cd C:\Users\User\OneDrive\Desktop\2

输入以下命令并按回车：

Bash

python process_reports.py
第四步：查看结果
脚本运行成功后，会输出“处理完成！”的提示。届时，在同一个文件夹内，您会找到一个新生成的CSV文件，文件名会根据您计算的日期自动生成，例如：产品日报_2025-08-25.csv。

这个文件就是您需要的最终报表。

5. 注意事项 (Notes)
LTV 和历史数据: 当前脚本版本中，LTV 和 历史消耗/历史充提差 字段为占位符 (0)。计算这些指标需要额外的历史数据和更复杂的累计逻辑，可以在未来作为第二阶段功能进行开发。

数据源准确性: 生成报表的准确性完全依赖于您提供的源文件的准确性。如果发现结果与预期不符，请首先检查源文件中的对应数据是否正确。

Excel 显示问题: 如果生成的 .csv 文件在您的Excel中打开时出现格式错乱（所有数据挤在一列）或日期显示为数字的情况，请参考我们之前讨论过的方法，使用Excel的 【数据】->【分列】 功能或 【设置单元格格式】 功能来修正显示。
