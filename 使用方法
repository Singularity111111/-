这是一份用于自动化生成数据日报的Python脚本使用手册。请按照以下步骤操作，即可轻松完成报表的生成。

第一部分：首次使用前的环境配置 (只需做一次)
如果您的电脑是第一次运行这个脚本，需要先花几分钟配置好环境。

步骤 1：安装 Python

首先，我们需要确保电脑上有Python环境。

检查是否已安装：

按下键盘上的 Win + R 键，在弹出的“运行”窗口中输入 cmd 并按回车，打开一个黑色命令窗口。

在窗口中输入 python --version 并按回车。

如果显示出 Python 的版本号（如 Python 3.9.7），说明已安装，请直接跳到步骤 2。

如果提示“不是内部或外部命令”，说明未安装，请继续下一步。

下载并安装 Python：

打开浏览器，访问Python官方网站：https://www.python.org/downloads/

点击页面上黄色的 "Download Python" 按钮，下载最新版的安装程序。

运行下载好的 .exe 安装程序。

【极其重要！】 在安装界面的最下方，务必勾选 “Add Python.exe to PATH” 这个选项，然后再点击 "Install Now"。

等待安装完成即可。

步骤 2：安装必要的工具库

我们的脚本需要两个辅助工具库 pandas 和 openpyxl 才能处理Excel文件。

同样，打开一个 cmd 命令窗口。

复制并粘贴以下命令，然后按回车：

Bash

pip install pandas openpyxl
等待命令运行完成，看到 "Successfully installed..." 字样即表示安装成功。

至此，您的电脑环境就已经完全配置好了！以后无需再重复以上步骤。

第二部分：准备工作 (每次运行前)
步骤 1：创建工作文件夹

在您方便的位置（例如桌面）创建一个新的文件夹，可以命名为“数据报表自动化”。

步骤 2：放入所有文件

将以下所有文件全部放入刚刚创建的“数据报表自动化”文件夹中，确保它们都在同一个地方：

process_reports.py (Python脚本)

Book1.xlsx (渠道数据源)

Book2.xlsx (产品数据源)

Book3.xlsx (部门映射表)

Book4.xlsx (复充率数据)

Book5.xlsx (消耗数据)

检查：您的文件夹看起来应该像这样：

第三部分：日常操作：生成报表
完成以上准备后，每天您只需要按照这几个简单的步骤来生成报表。

步骤 1：配置报表日期

右键点击 process_reports.py 脚本文件，选择用“记事本”或其它文本编辑器打开。

在文件顶部找到 REPORT_DATE 这一行配置：

Python

# 报表日期（设为None则自动使用最新日期）
REPORT_DATE = '2025-08-29' # 例如: '2025-08-29'
根据您的需求修改：

生成指定日期：将 '2025-08-29' 修改为您需要的日期即可。

自动生成最新日期：将这一行改为 REPORT_DATE = None。

修改后，保存并关闭文件。

步骤 2：运行脚本

在“数据报表自动化”文件夹的地址栏里，输入 cmd 并按回车。这会直接打开一个定位到当前文件夹的命令窗口。

在打开的黑色命令窗口中，输入以下命令并按回车：

Bash

python process_reports.py
脚本会自动开始运行，您会看到窗口中输出一连串的处理日志，这表示一切正常。

步骤 3：获取报表

等待脚本运行结束（当窗口不再输出新内容，并出现新的命令行提示符时），您会发现在“数据报表自动化”文件夹中，已经生成了三份最新的CSV报表文件！

您可以直接用Excel打开这些CSV文件。至此，日报生成工作就全部完成了！

第四部分：常见问题解答
如果在运行过程中遇到问题，请参考以下解决方法：

问题1：报错 Permission denied: 'Book1.xlsx'

原因：您要处理的Excel文件正在被电脑上的Excel程序打开并占用。

解决方法：关闭所有已打开的Excel窗口，然后重新运行脚本即可。

问题2：报错 KeyError: '某个列名'

原因：脚本在某个Excel文件中找不到它需要的列。这通常是因为列标题有不易发现的空格或错别字。

解决方法：请打开对应的Excel文件，仔细检查报错信息中提到的那个“列名”是否存在，并确保没有多余的空格或文字错误。
